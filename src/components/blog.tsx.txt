import React, { useState, useEffect } from 'react';
import { useParams, useNavigate, Link } from 'react-router-dom';

interface BlogPost {
  id: string;
  title: string;
  date: string;
  description: string;
  slug: string;
  category: string;
  author: string;
  content: string;
  image?: string;
  tags: string[];
  readTime: string;
}

interface BlogProps {
  viewMode?: 'list' | 'single';
}

const Blog: React.FC<BlogProps> = ({ viewMode = 'list' }) => {
  const { slug } = useParams<{ slug: string }>();
  const navigate = useNavigate();
  const [posts, setPosts] = useState<BlogPost[]>([]);
  const [currentPost, setCurrentPost] = useState<BlogPost | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string>('');

  // Sample blog posts with full content
  const samplePosts: BlogPost[] = [
    {
      id: '1',
      title: "Understanding USD to EUR Exchange Rates",
      date: "2024-08-07",
      description: "Learn how exchange rates work and what factors influence them in today's global economy.",
      slug: "usd-eur-exchange-rates",
      category: "Exchange Rates",
      author: "Currency Expert",
      readTime: "5 min read",
      tags: ["USD", "EUR", "Exchange Rates", "Economics"],
      image: "/images/blog/usd-eur.jpg",
      content: `
# Understanding USD to EUR Exchange Rates

Exchange rates between the US Dollar (USD) and Euro (EUR) are among the most watched currency pairs in the world. Understanding how these rates work can save you money and help you make better financial decisions.

## What Determines Exchange Rates?

Several key factors influence the USD/EUR exchange rate:

### 1. Economic Indicators
- **GDP Growth**: Countries with stronger economic growth typically see their currencies strengthen
- **Inflation Rates**: Lower inflation generally supports a stronger currency
- **Employment Data**: Strong job markets indicate economic health

### 2. Central Bank Policies
- **Interest Rates**: Higher interest rates attract foreign investment, strengthening the currency
- **Quantitative Easing**: Money printing typically weakens a currency
- **Forward Guidance**: Central bank communications can move markets

### 3. Political Stability
- **Elections**: Political uncertainty can cause currency volatility
- **Trade Policies**: Tariffs and trade agreements affect exchange rates
- **Geopolitical Events**: Wars, sanctions, and diplomatic tensions impact currencies

## How to Read Exchange Rate Charts

When you see EUR/USD = 1.0850, this means:
- 1 Euro equals 1.0850 US Dollars
- You need $1.0850 to buy 1 Euro

## Best Times to Exchange Currency

### Timing Matters
- **Avoid weekends**: Markets are closed, spreads are wider
- **Watch major announcements**: Central bank meetings can cause volatility
- **Consider seasonal patterns**: Some currencies have predictable seasonal trends

### Money-Saving Tips
1. **Use our currency converter** to track rates
2. **Set rate alerts** for your target exchange rate
3. **Avoid airport exchanges** - they have the worst rates
4. **Consider timing large exchanges** around major economic announcements

## The Psychology of Currency Exchange

Many people make emotional decisions when exchanging money, especially when traveling. Understanding your **money mindset** can help you make more rational currency decisions.

Fear of missing out (FOMO) and loss aversion often lead to poor timing. Instead of trying to time the market perfectly, focus on:
- Getting reasonable rates
- Avoiding high-fee exchanges
- Understanding your actual currency needs

## Conclusion

Exchange rates are complex, but understanding the basics can save you money. Use reliable tools, avoid emotional decisions, and remember that small improvements in rates can lead to significant savings over time.

*Ready to dive deeper into your relationship with money? Discover how your mindset affects every financial decision you make.*
      `
    },
    {
      id: '2',
      title: "Best Ways to Exchange Money for Travel",
      date: "2024-08-06",
      description: "Save money on currency exchange when traveling abroad with these proven strategies.",
      slug: "travel-money-exchange",
      category: "Travel Money",
      author: "Travel Finance Expert",
      readTime: "7 min read",
      tags: ["Travel", "Currency Exchange", "Money Saving", "Tips"],
      image: "/images/blog/travel-money.jpg",
      content: `
# Best Ways to Exchange Money for Travel

Traveling internationally means dealing with foreign currency, and how you handle this can significantly impact your travel budget. Here's your complete guide to smart currency exchange.

## Before You Travel

### 1. Research Your Destination's Currency
- Learn the local currency code (EUR, GBP, JPY, etc.)
- Understand typical denominations
- Check if US dollars are widely accepted
- Research tipping customs and cash vs. card preferences

### 2. Notify Your Bank
- Call your bank and credit card companies
- Inform them of your travel dates and destinations
- Ask about foreign transaction fees
- Inquire about partner banks abroad

## Currency Exchange Options Ranked

### 🥇 Best Options

**1. ATMs at Your Destination**
- **Pros**: Best exchange rates, convenient, secure
- **Cons**: ATM fees, daily withdrawal limits
- **Tip**: Use bank-affiliated ATMs when possible

**2. Your Bank Before Travel**
- **Pros**: No surprises, you can budget in advance
- **Cons**: May need to order currency in advance
- **Tip**: Order 2-3 weeks before travel

**3. Online Currency Exchange Services**
- **Pros**: Competitive rates, delivered to your door
- **Cons**: Need to plan ahead
- **Examples**: Wise (formerly TransferWise), Currency Exchange International

### 🥈 Decent Options

**4. Credit Cards with No Foreign Transaction Fees**
- **Pros**: Convenient, good rates, fraud protection
- **Cons**: Not accepted everywhere
- **Recommended**: Chase Sapphire, Capital One Venture

**5. Currency Exchange Kiosks in Major Cities**
- **Pros**: Convenient locations
- **Cons**: Higher rates than banks
- **Tip**: Compare rates between different kiosks

### 🥉 Avoid These

**6. Airport Currency Exchange**
- **Why avoid**: Extremely poor rates (5-15% markup)
- **Exception**: Small amounts for immediate needs

**7. Hotels**
- **Why avoid**: Terrible rates, high fees
- **Exception**: Emergency situations only

**8. Dynamic Currency Conversion**
- **What it is**: When merchants offer to charge your card in your home currency
- **Why avoid**: Hidden fees of 3-5%
- **Always**: Choose to pay in local currency

## Smart Exchange Strategies

### The 80/20 Rule
- Exchange 80% through the best available method
- Keep 20% flexibility for unexpected needs

### Diversify Your Money Access
- Primary: ATM/debit card
- Backup: Credit card with no foreign fees
- Emergency: Small amount of cash exchanged before travel

### Use Technology
- **Currency converter apps** for real-time rates
- **Rate alert apps** to track favorable exchange times
- **Banking apps** to monitor your accounts

## Conclusion

Smart currency exchange is about preparation, research, and avoiding emotional decisions. The money you save on better exchange rates is money you can spend enjoying your travels.

Remember: your relationship with money doesn't take a vacation. The same mindset principles that help you manage money at home apply when traveling.

*Want to develop a healthier relationship with money that serves you at home and abroad? Explore our resources on money mindset transformation.*
      `
    },
    {
      id: '3',
      title: "How Exchange Rates Affect Your Wealth",
      date: "2024-08-05",
      description: "Discover how currency fluctuations impact your investments and what you can do about it.",
      slug: "exchange-rates-wealth-impact",
      category: "Investment",
      author: "Wealth Strategist",
      readTime: "6 min read",
      tags: ["Wealth Building", "Investment", "Exchange Rates", "Money Mindset"],
      image: "/images/blog/wealth-exchange.jpg",
      content: `
# How Exchange Rates Affect Your Wealth (And What To Do About It)

Most people think exchange rates only matter when they travel. The truth? Currency fluctuations are quietly affecting your wealth every day, even if you never leave your home country.

## The Hidden Impact on Your Portfolio

### International Investments
If you own:
- **International stocks or ETFs**
- **Foreign bonds**
- **Global mutual funds**
- **Cryptocurrency**

You're already exposed to currency risk. When the dollar strengthens against other currencies, your international investments lose value in dollar terms, even if they're performing well in their local currency.

## Building Currency Awareness

### Daily Habits
- **Check major currency pairs** along with stock indices
- **Read international news** to understand currency drivers
- **Track your international exposure** quarterly

### Educational Resources
- **Central bank websites**: Fed, ECB, Bank of Japan
- **Economic calendars**: ForexFactory, Investing.com
- **Currency analysis**: Bloomberg, Reuters

## The Money Mindset Connection

Your approach to currency risk reveals deeper beliefs about money:

### Scarcity Mindset Signs:
- Avoiding international investments due to "unknown risks"
- Trying to time currency movements perfectly
- Letting fear drive all currency decisions

### Abundance Mindset Approach:
- Viewing currency diversification as opportunity
- Understanding that volatility creates wealth over time
- Making strategic, educated decisions

## Conclusion

Currency fluctuations are a permanent feature of global investing. Instead of fearing them or ignoring them, successful wealth builders learn to understand and strategically manage currency risk.

The goal isn't to eliminate currency risk—it's to be intentional about it. Just like any other aspect of wealth building, success comes from education, strategy, and disciplined execution.

Remember: Your relationship with money includes how you think about currencies. Expanding your perspective beyond your home currency is part of developing a truly wealthy mindset.

*Ready to transform your entire approach to money? Discover how your money mindset shapes every financial decision you make.*
      `
    }
  ];

  useEffect(() => {
    const loadPosts = async () => {
      setLoading(true);
      setError('');
      
      try {
        // Simulate API call delay
        await new Promise(resolve => setTimeout(resolve, 500));
        
        setPosts(samplePosts);
        
        // If viewing a single post, find it by slug
        if (slug && viewMode === 'single') {
          const post = samplePosts.find(p => p.slug === slug);
          if (post) {
            setCurrentPost(post);
          } else {
            setError('Blog post not found');
          }
        }
      } catch (err) {
        setError('Failed to load blog posts');
        console.error('Error loading posts:', err);
      } finally {
        setLoading(false);
      }
    };

    loadPosts();
  }, [slug, viewMode]);

  const handleReadMore = (postSlug: string) => {
    navigate(`/blog/${postSlug}`);
  };

  const formatContent = (content: string) => {
    // Convert markdown-style content to HTML for display
    return content
      .replace(/^# (.*$)/gm, '<h1 class="text-3xl font-bold mb-4 text-gray-900">$1</h1>')
      .replace(/^## (.*$)/gm, '<h2 class="text-2xl font-bold mb-3 mt-6 text-gray-900">$1</h2>')
      .replace(/^### (.*$)/gm, '<h3 class="text-xl font-semibold mb-2 mt-4 text-gray-800">$1</h3>')
      .replace(/^\*\*(.*)\*\*/gm, '<strong class="font-semibold text-gray-900">$1</strong>')
      .replace(/^\*(.*)\*/gm, '<em class="italic">$1</em>')
      .replace(/^- (.*$)/gm, '<li class="mb-1">$1</li>')
      .replace(/\n\n/g, '</p><p class="mb-4">')
      .replace(/^(?!<[h|l|p])/gm, '<p class="mb-4">')
      .replace(/\*([^*]+)\*/g, '<em class="italic">$1</em>');
  };

  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50">
        <div className="container mx-auto px-4 py-8">
          <div className="max-w-4xl mx-auto">
            <div className="animate-pulse">
              <div className="h-8 bg-gray-200 rounded mb-4"></div>
              <div className="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
                {[1, 2, 3].map((i) => (
                  <div key={i} className="bg-white rounded-lg shadow-lg p-6">
                    <div className="h-4 bg-gray-200 rounded mb-2"></div>
                    <div className="h-6 bg-gray-200 rounded mb-3"></div>
                    <div className="h-16 bg-gray-200 rounded mb-4"></div>
                    <div className="h-4 bg-gray-200 rounded"></div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="min-h-screen bg-gray-50 flex items-center justify-center">
        <div className="text-center">
          <div className="text-red-500 text-xl mb-4">⚠️ {error}</div>
          <Link 
            to="/blog" 
            className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"
          >
            Back to Blog
          </Link>
        </div>
      </div>
    );
  }

  // Single post view
  if (viewMode === 'single' && currentPost) {
    return (
      <div className="min-h-screen bg-gray-50">
        <div className="container mx-auto px-4 py-8">
          <div className="max-w-4xl mx-auto">
            {/* Back button */}
            <Link 
              to="/blog" 
              className="inline-flex items-center text-blue-600 hover:text-blue-800 mb-6"
            >
              ← Back to Blog
            </Link>

            <article className="bg-white rounded-lg shadow-lg overflow-hidden">
              {currentPost.image && (
                <div className="h-64 bg-gray-200 flex items-center justify-center">
                  <span className="text-gray-500">Featured Image Placeholder</span>
                </div>
              )}
              
              <div className="p-8">
                <div className="flex items-center justify-between mb-4">
                  <span className="text-sm font-semibold text-blue-600 bg-blue-100 px-3 py-1 rounded-full">
                    {currentPost.category}
                  </span>
                  <span className="text-sm text-gray-500">{currentPost.readTime}</span>
                </div>

                <h1 className="text-4xl font-bold mb-4 text-gray-900">
                  {currentPost.title}
                </h1>

                <div className="flex items-center justify-between mb-6 text-sm text-gray-600">
                  <span>By {currentPost.author}</span>
                  <span>{new Date(currentPost.date).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                  })}</span>
                </div>

                <div className="flex flex-wrap gap-2 mb-6">
                  {currentPost.tags.map((tag) => (
                    <span 
                      key={tag} 
                      className="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded"
                    >
                      {tag}
                    </span>
                  ))}
                </div>

                <div 
                  className="prose prose-lg max-w-none"
                  dangerouslySetInnerHTML={{ 
                    __html: formatContent(currentPost.content) 
                  }}
                />
              </div>
            </article>

            {/* Related posts */}
            <div className="mt-12 bg-blue-50 rounded-lg p-8 text-center">
              <h3 className="text-2xl font-bold mb-4">Ready to Transform Your Money Mindset?</h3>
              <p className="text-gray-700 mb-6">
                Understanding currency is just the beginning. Discover how to transform your 
                relationship with money and build lasting wealth.
              </p>
              <Link 
                to="/books" 
                className="inline-block bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors"
              >
                Explore Our Money Mindset Books
              </Link>
            </div>
          </div>
        </div>
      </div>
    );
  }

  // Blog list view
  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        <div className="max-w-6xl mx-auto">
          <div className="text-center mb-12">
            <h1 className="text-4xl font-bold mb-4 text-gray-900">Currency & Finance Blog</h1>
            <p className="text-xl text-gray-600 max-w-2xl mx-auto">
              Master currency exchange, build wealth, and transform your relationship with money
            </p>
          </div>
          
          <div className="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
            {posts.map((post) => (
              <article 
                key={post.id}
                className="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group"
              >
                {post.image && (
                  <div className="h-48 bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center">
                    <span className="text-white font-semibold">Featured Image</span>
                  </div>
                )}
                
                <div className="p-6">
                  <div className="flex items-center justify-between mb-3">
                    <span className="text-sm font-semibold text-blue-600 bg-blue-100 px-3 py-1 rounded-full">
                      {post.category}
                    </span>
                    <span className="text-sm text-gray-500">{post.readTime}</span>
                  </div>
                  
                  <h2 className="text-xl font-bold mb-3 text-gray-900 group-hover:text-blue-600 transition-colors">
                    {post.title}
                  </h2>
                  
                  <p className="text-gray-600 mb-4 line-clamp-3">
                    {post.description}
                  </p>

                  <div className="flex flex-wrap gap-1 mb-4">
                    {post.tags.slice(0, 3).map((tag) => (
                      <span 
                        key={tag} 
                        className="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded"
                      >
                        {tag}
                      </span>
                    ))}
                  </div>
                  
                  <div className="flex items-center justify-between">
                    <div className="text-sm text-gray-500">
                      <div>{post.author}</div>
                      <div>{new Date(post.date).toLocaleDateString()}</div>
                    </div>
                    
                    <button
                      onClick={() => handleReadMore(post.slug)}
                      className="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                    >
                      Read More →
                    </button>
                  </div>
                </div>
              </article>
            ))}
          </div>

          {/* Call to action */}
          <div className="mt-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg p-8 text-center text-white">
            <h3 className="text-3xl font-bold mb-4">Transform Your Money Mindset Today</h3>
            <p className="text-xl mb-6 opacity-90">
              Ready to go beyond currency conversion? Discover the psychology behind wealth building 
              and learn how to master your relationship with money.
            </p>
            <Link 
              to="/books" 
              className="inline-block bg-white text-blue-600 px-8 py-4 rounded-lg font-semibold text-lg hover:bg-gray-100 transition-colors"
            >
              Explore Money Mindset Books
            </Link>
          </div>
        </div>
      </div>
    </div>
  );
};

export default Blog;